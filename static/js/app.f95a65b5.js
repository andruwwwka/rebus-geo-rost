(function(t){function n(n){for(var a,o,s=n[0],c=n[1],l=n[2],u=0,f=[];u<s.length;u++)o=s[u],i[o]&&f.push(i[o][0]),i[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);d&&d(n);while(f.length)f.shift()();return r.push.apply(r,l||[]),e()}function e(){for(var t,n=0;n<r.length;n++){for(var e=r[n],a=!0,o=1;o<e.length;o++){var c=e[o];0!==i[c]&&(a=!1)}a&&(r.splice(n--,1),t=s(s.s=e[0]))}return t}var a={},i={app:0},r=[];function o(t){return s.p+"js/"+({about:"about"}[t]||t)+"."+{about:"8c221df5"}[t]+".js"}function s(n){if(a[n])return a[n].exports;var e=a[n]={i:n,l:!1,exports:{}};return t[n].call(e.exports,e,e.exports,s),e.l=!0,e.exports}s.e=function(t){var n=[],e=i[t];if(0!==e)if(e)n.push(e[2]);else{var a=new Promise(function(n,a){e=i[t]=[n,a]});n.push(e[2]=a);var r,c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=o(t),r=function(n){c.onerror=c.onload=null,clearTimeout(l);var e=i[t];if(0!==e){if(e){var a=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src,o=new Error("Loading chunk "+t+" failed.\n("+a+": "+r+")");o.type=a,o.request=r,e[1](o)}i[t]=void 0}};var l=setTimeout(function(){r({type:"timeout",target:c})},12e4);c.onerror=c.onload=r,document.head.appendChild(c)}return Promise.all(n)},s.m=t,s.c=a,s.d=function(t,n,e){s.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,n){if(1&n&&(t=s(t)),8&n)return t;if(4&n&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(s.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var a in t)s.d(e,a,function(n){return t[n]}.bind(null,a));return e},s.n=function(t){var n=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(n,"a",n),n},s.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},s.p="/",s.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=n,c=c.slice();for(var u=0;u<c.length;u++)n(c[u]);var d=l;r.push([0,"chunk-vendors"]),e()})({0:function(t,n,e){t.exports=e("56d7")},"034f":function(t,n,e){"use strict";var a=e("64a9"),i=e.n(a);i.a},54901:function(t,n,e){"use strict";var a=e("bdf3"),i=e.n(a);i.a},"56d7":function(t,n,e){"use strict";e.r(n);e("cadf"),e("551c"),e("f751"),e("097d");var a=e("2b0e"),i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},r=[],o=(e("034f"),e("2877")),s={},c=Object(o["a"])(s,i,r,!1,null,null,null),l=c.exports,u=e("8c4f"),d=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"home"},[e("MapContainer")],1)},f=[],p=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"reb-MapContainer"},[e("Map",{attrs:{filter:t.filter}}),e("CatFilter",{attrs:{items:t.items},on:{"filter-change":t.filterChange}})],1)},h=[],m=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"reb-Map"},[e("yandex-map",{staticStyle:{width:"100%",height:"100%"},attrs:{settings:t.settings,coords:[57.617499,39.924038],zoom:"12","cluster-options":{1:{clusterDisableClickZoom:!0}},behaviors:[],controls:[],"map-type":"map"},on:{"map-was-initialized":t.initHandler}}),e("canvas",{ref:"my-canvas",staticClass:"reb-Map__canvas"})],1)},v=[],b=e("5490"),g=e("bc3a"),C=e.n(g),_={name:"Map",props:{filter:Array,msg:String},data:function(){return{settings:{apiKey:"c55b9816-9c45-4a43-a45a-4505c813e193",lang:"ru_RU",coordorder:"latlong",version:"2.1"},mapInstance:void 0,mapBounds:void 0,latHeight:void 0,lonWidth:void 0,mapWidth:void 0,mapHeight:void 0,geoData:[{id:1,rating:1,lat1:57.520544,lat2:57.525544,lon1:39.695266,lon2:39.700266},{id:2,rating:2,lat1:57.520544,lon1:39.700267,lat2:57.525544,lon2:39.705267},{id:3,rating:3,lat1:57.520544,lon1:39.705268,lat2:57.525544,lon2:39.710268},{id:4,rating:1,lat1:57.520544,lon1:39.710269,lat2:57.525544,lon2:39.715269}]}},watch:{filter:function(t){this.updateData()}},mounted:function(){this.updateData()},methods:{ratingToColor:function(t){switch(t){case 1:return"#D50005";case 2:return"#FFCC33";case 3:return"#00CC33";default:return"#FFFFFF"}},updateData:function(){var t=this;C.a.get("https://rebus-hackaton.herokuapp.com/geo_data/ratings/"+this.stringFilter).then(function(n){t.geoData=n.data,t.drawGeoDataToCanvas()}).catch(function(t){console.log(t)})},drawGeoDataToCanvas:function(){if(this.mapBounds&&this.geoData){this.calcMapSizes();var t=this.$refs["my-canvas"];t.width=this.mapWidth,t.height=this.mapHeight;var n=t.getContext("2d");n.clearRect(0,0,t.width,t.height);for(var e=0,a=this.geoData.length;e<a;e++){var i=this.geoData[e],r=this.ratingToColor(i.rating);n.fillStyle=r;var o=this.lonLatToXY(i.lon1,i.lat1),s=this.lonLatToXY(i.lon2,i.lat2);n.fillRect(o[0],o[1],s[0]-o[0],s[1]-o[1])}}},calcMapSizes:function(){this.latHeight=this.mapBounds[1][0]-this.mapBounds[0][0],this.lonWidth=this.mapBounds[1][1]-this.mapBounds[0][1],this.mapWidth=this.mapInstance.container.getMapSize()[0],this.mapHeight=this.mapInstance.container.getMapSize()[1]},lonLatToXY:function(t,n){var e=(t-this.mapBounds[0][1])/this.lonWidth*this.mapWidth,a=(n-this.mapBounds[0][0])/this.latHeight*this.mapHeight;return[e,a]},initHandler:function(t){this.mapInstance=t,this.mapBounds=t.getBounds(),this.drawGeoDataToCanvas()}},computed:{stringFilter:function(){return this.filter&&this.filter.length?"?kind="+this.filter.join(","):""}},components:{yandexMap:b["a"],ymapMarker:b["b"]}},y=_,w=(e("54901"),Object(o["a"])(y,m,v,!1,null,null,null)),M=w.exports,F=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"reb-CatFilter"},[e("div",{staticClass:"reb-CatFilter__list"},t._l(t.items,function(n){return e("div",{staticClass:"reb-CatFilter__item",class:{"reb-CatFilter__item-inactive":!n.enabled},on:{click:function(e){return t.itemClick(n)}}},[e("span"),e("span",[t._v(t._s(n.name))])])}),0)])},j=[],k={name:"CatFilter",props:{items:Array},data:function(){return{}},methods:{itemToIconSrc:function(t){return"../assets/"+t.icon+".svg"},itemClick:function(t){t.enabled=!t.enabled,this.$emit("filter-change",this.items)}}},x=k,O=(e("dfaf"),Object(o["a"])(x,F,j,!1,null,null,null)),T=O.exports,D={name:"MapContainer",data:function(){return{items:[{id:"infant_school",name:"Дошкольные учреждения",enabled:!0,icon:"kindergarten"},{id:"school",name:"Школы",enabled:!0,icon:"school"},{id:"bus_station",name:"Транспорт",enabled:!1,icon:"bus"},{id:"hospital",name:"Медучреждения",enabled:!1,icon:"medicine"},{id:"culture",name:"Культурные объекты",enabled:!0,icon:"culture"},{id:"sports_ground",name:"Спортивные объекты",enabled:!0,icon:"sport"},{id:"post_office",name:"Почтовые отделения",enabled:!0,icon:"basket"},{id:"waste_points",name:"Пункты РСО",enabled:!1,icon:"basket"}]}},methods:{filterChange:function(t){}},computed:{filter:function(){for(var t=[],n=0,e=this.items.length;n<e;n++)this.items[n].enabled&&t.push(this.items[n].id);return t}},components:{CatFilter:T,Map:M}},S=D,B=(e("b7de"),Object(o["a"])(S,p,h,!1,null,null,null)),H=B.exports,P={name:"home",components:{MapContainer:H}},$=P,E=(e("cccb"),Object(o["a"])($,d,f,!1,null,null,null)),W=E.exports;a["a"].use(u["a"]);var z=new u["a"]({routes:[{path:"/",name:"home",component:W},{path:"/about",name:"about",component:function(){return e.e("about").then(e.bind(null,"f820"))}}]});a["a"].config.productionTip=!1,new a["a"]({router:z,render:function(t){return t(l)}}).$mount("#app")},"64a9":function(t,n,e){},"9f0f":function(t,n,e){},b7de:function(t,n,e){"use strict";var a=e("dd02"),i=e.n(a);i.a},bdf3:function(t,n,e){},cccb:function(t,n,e){"use strict";var a=e("d563"),i=e.n(a);i.a},d563:function(t,n,e){},dd02:function(t,n,e){},dfaf:function(t,n,e){"use strict";var a=e("9f0f"),i=e.n(a);i.a}});
//# sourceMappingURL=app.f95a65b5.js.map